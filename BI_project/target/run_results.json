{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-11T21:12:22.046165Z", "invocation_id": "17ba8e95-1a53-450c-9b75-4f6bd11e113d", "invocation_started_at": "2025-11-11T21:12:20.020824Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.281725Z", "completed_at": "2025-11-11T21:12:21.404843Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.405458Z", "completed_at": "2025-11-11T21:12:21.521399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.24146032333374023, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.dim_isla", "compiled": true, "compiled_code": "select\n  codigo_isla,\n  nombre_isla\nfrom \"ods_db\".\"public\".\"dim_isla_seed\"", "relation_name": "\"ods_db\".\"public\".\"dim_isla\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.527706Z", "completed_at": "2025-11-11T21:12:21.530650Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.531153Z", "completed_at": "2025-11-11T21:12:21.573575Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04737424850463867, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.dim_parque", "compiled": true, "compiled_code": "select distinct\n  codigo_parque\nfrom \"ods_db\".\"public\".\"dim_parque_seed\"", "relation_name": "\"ods_db\".\"public\".\"dim_parque\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.578327Z", "completed_at": "2025-11-11T21:12:21.581308Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.581820Z", "completed_at": "2025-11-11T21:12:21.625736Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.048943519592285156, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_aguas_residuales", "compiled": true, "compiled_code": "with base as (\n  select\n    trim(time_period_code)                      as anyo,\n    territorio_code                             as codigo_isla,\n    trim(medidas)                               as medida,\n    trim(medidas_code)                          as codigo_medida,\n    upper(trim(tipo_destino_uso))               as destino,    \n    upper(trim(tipo_destino_uso_code))          as codigo_destino,\n    cast(obs_value as numeric)                  as valor_medicion\n  from \"ods_db\".\"public\".\"aguas_residuales\"\n)\n\n\nselect\n  to_date(anyo || '-01-01','YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  codigo_destino,\n  destino,\n  valor_medicion\nfrom base\nwhere upper(destino) LIKE '%AL MAR%'", "relation_name": "\"ods_db\".\"public\".\"stg_aguas_residuales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.630387Z", "completed_at": "2025-11-11T21:12:21.633415Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.633903Z", "completed_at": "2025-11-11T21:12:21.678565Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.049645423889160156, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_infracciones_acpmn", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(tipo_infraccion))       as tipo_infraccion,    \n    upper(trim(tipo_infraccion_code))  as codigo_tipo_infraccion,\n    territorio_code                         as codigo_isla,\n    trim(time_period_code)                  as anyo,\n    trim(medidas)                           as medida,\n    trim(medidas_code)                      as codigo_medida,\n    cast(obs_value as numeric)              as valor_medicion\n  from \"ods_db\".\"public\".\"infracciones_acpmn\"\n)\n\nselect\n  to_date(anyo || '-01-01','YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_tipo_infraccion,\n  tipo_infraccion,\n  codigo_medida,\n  valor_medicion\nfrom base", "relation_name": "\"ods_db\".\"public\".\"stg_infracciones_acpmn\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.683138Z", "completed_at": "2025-11-11T21:12:21.686443Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.686959Z", "completed_at": "2025-11-11T21:12:21.729984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.048397064208984375, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_infracciones_ambientales", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(geographical_code))                  as codigo_isla,\n    time_code                                       as anyo,\n    trim(measure)                                   as medida,\n    trim(measure_code)                              as codigo_medida,\n    cast(obs_value as numeric)                      as valor_medicion\n  from \"ods_db\".\"public\".\"infracciones_ambientales\"\n)\n\nselect\n  to_date(anyo || '-01-01','YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  medida,\n  valor_medicion\nfrom base", "relation_name": "\"ods_db\".\"public\".\"stg_infracciones_ambientales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.735108Z", "completed_at": "2025-11-11T21:12:21.738218Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.738710Z", "completed_at": "2025-11-11T21:12:21.784788Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05126070976257324, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_turistas_recibidos", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(geographical_code))          as codigo_isla,\n    trim(time_code)                         as time_code_raw,\n    trim(measure)                           as medida,\n    trim(measure_code)                      as codigo_medida,\n    cast(obs_value as numeric)              as valor_medicion\n  from \"ods_db\".\"public\".\"turistas_recibidos\"\n)\n\nselect\n  to_date(time_code_raw || '-01', 'YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  medida,\n  valor_medicion\nfrom base\nwhere time_code_raw !~* '^\\d{4}$'", "relation_name": "\"ods_db\".\"public\".\"stg_turistas_recibidos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.790110Z", "completed_at": "2025-11-11T21:12:21.792956Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.793521Z", "completed_at": "2025-11-11T21:12:21.836824Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04850316047668457, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_visitantes_espacios_naturales", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(espacio_natural_protegido_code))     as codigo_parque,\n    trim(time_period_code)                          as raw_anyo,\n    trim(medidas)                                   as medida,\n    trim(medidas_code)                              as codigo_medida,\n    cast(obs_value as numeric)                      as valor_medicion\n  from \"ods_db\".\"public\".\"visitantes_espacios_naturales\"\n)\n\nselect\n  case\n    when raw_anyo ~ '^\\d{4}$' then to_date(raw_anyo || '-01-01','YYYY-MM-DD')\n    when raw_anyo ~ '^\\d{4}-M\\d{2}$' then to_date(regexp_replace(raw_anyo, '-M', '-') || '-01','YYYY-MM-DD')\n    else null\n  end as fecha_aproximada,\n  codigo_parque,\n  codigo_medida,\n  medida,\n  valor_medicion\n  from base", "relation_name": "\"ods_db\".\"public\".\"stg_visitantes_espacios_naturales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.842149Z", "completed_at": "2025-11-11T21:12:21.845181Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.845712Z", "completed_at": "2025-11-11T21:12:21.882194Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04225015640258789, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.f_infracciones_ambientales_mes", "compiled": true, "compiled_code": "with base as (\n  select\n    ia.fecha_aproximada,\n    ia.codigo_isla,\n    i.nombre_isla,\n    ia.valor_medicion::numeric as n_infracciones_ambientales\n  from \"ods_db\".\"public\".\"stg_infracciones_ambientales\" ia\n  join \"ods_db\".\"public\".\"dim_isla\" i\n    on i.codigo_isla = ia.codigo_isla\n  where ia.codigo_medida LIKE '%ABSOLUTE%'\n  order by ia.codigo_isla, ia.fecha_aproximada\n)\nselect\n  fecha_aproximada,\n  codigo_isla,\n  nombre_isla,\n  n_infracciones_ambientales\nfrom base", "relation_name": "\"ods_db\".\"public\".\"f_infracciones_ambientales_mes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.886787Z", "completed_at": "2025-11-11T21:12:21.889977Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.890419Z", "completed_at": "2025-11-11T21:12:21.928642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04335451126098633, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.f_turistas_isla_mes", "compiled": true, "compiled_code": "with base as (\n  select\n    tr.fecha_aproximada,\n    tr.codigo_isla,\n    i.nombre_isla,\n    tr.valor_medicion::numeric as n_turistas\n  from \"ods_db\".\"public\".\"stg_turistas_recibidos\" tr\n  join \"ods_db\".\"public\".\"dim_isla\" i\n    on i.codigo_isla = tr.codigo_isla\n  where tr.codigo_medida LIKE '%ABSOLUTE%'\n  order by tr.codigo_isla, tr.fecha_aproximada\n  -- group by tr.fecha_aproximada, tr.codigo_isla, tr.codigo_medida, i.nombre_isla\n  -- having tr.codigo_medida LIKE '%ABSOLUTE%'\n)\nselect\n  fecha_aproximada,\n  codigo_isla,\n  nombre_isla,\n  n_turistas\nfrom base", "relation_name": "\"ods_db\".\"public\".\"f_turistas_isla_mes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.934067Z", "completed_at": "2025-11-11T21:12:21.937432Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.937892Z", "completed_at": "2025-11-11T21:12:21.977307Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0447993278503418, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.m_aguas_turistas", "compiled": true, "compiled_code": "with turistas_anyo as (\n  select\n  EXTRACT(YEAR FROM fecha_aproximada)::int as anyo,\n  codigo_isla,\n  nombre_isla,\n  sum(n_turistas) as n_turistas\n  from \"ods_db\".\"public\".\"f_turistas_isla_mes\"\n  group by anyo, codigo_isla, nombre_isla\n  having EXTRACT(YEAR FROM fecha_aproximada)::int >= 2010 and \n  EXTRACT(YEAR FROM fecha_aproximada)::int <= 2024 and\n  codigo_isla LIKE '%ES70'\n),\n\naguas_anyo as (\n  select\n  EXTRACT(YEAR FROM fecha_aproximada)::int as anyo,\n  codigo_isla,\n  sum(valor_medicion) as v_aguas_residuales\n  from \"ods_db\".\"public\".\"stg_aguas_residuales\"\n  group by anyo, codigo_isla, codigo_medida\n  having EXTRACT(YEAR FROM fecha_aproximada)::int >= 2020 and \n  EXTRACT(YEAR FROM fecha_aproximada)::int <= 2025 and\n  codigo_isla LIKE '%ES70' and\n  codigo_medida LIKE '%VOLUMEN'\n)\n\nselect\n  t.anyo,\n  t.codigo_isla,\n  t.nombre_isla,\n  t.n_turistas as n_turistas,\n  a.v_aguas_residuales as v_aguas_residuales,\n  ln(t.n_turistas) as escalado_turistas,\n  ln(a.v_aguas_residuales) as escalado_aguas_residuales\nfrom turistas_anyo t\nfull join aguas_anyo a\non t.anyo = a.anyo", "relation_name": "\"ods_db\".\"public\".\"m_aguas_turistas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-11T21:12:21.982187Z", "completed_at": "2025-11-11T21:12:21.985400Z"}, {"name": "execute", "started_at": "2025-11-11T21:12:21.985910Z", "completed_at": "2025-11-11T21:12:22.023957Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04328012466430664, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.m_turistas_infracciones_a\u00f1o", "compiled": true, "compiled_code": "with turistas_anyo as (\n  select\n  EXTRACT(YEAR FROM fecha_aproximada)::int as anyo,\n  codigo_isla,\n  nombre_isla,\n  sum(n_turistas) as n_turistas\n  from \"ods_db\".\"public\".\"f_turistas_isla_mes\"\n  group by anyo, codigo_isla, nombre_isla\n  having EXTRACT(YEAR FROM fecha_aproximada)::int >= 2010 and \n  EXTRACT(YEAR FROM fecha_aproximada)::int <= 2024 and\n  codigo_isla LIKE '%ES70'\n),\n\ninfracciones_ambientales_anyo as (\n  select\n  EXTRACT(YEAR FROM fecha_aproximada)::int as anyo,\n  codigo_isla,\n  nombre_isla,\n  sum(n_infracciones_ambientales) as n_infracciones_ambientales\n  from \"ods_db\".\"public\".\"f_infracciones_ambientales_mes\"\n  group by anyo, codigo_isla, nombre_isla\n  having EXTRACT(YEAR FROM fecha_aproximada)::int >= 2010 and \n  EXTRACT(YEAR FROM fecha_aproximada)::int <= 2024 and\n  codigo_isla LIKE '%ES70'\n)\n\nselect\n  t.anyo,\n  t.codigo_isla,\n  t.nombre_isla,\n  t.n_turistas as n_turistas,\n  i.n_infracciones_ambientales as n_infracciones_ambientales,\n  ln(t.n_turistas) as escalado_turistas,\n  ln(i.n_infracciones_ambientales) as escalado_infracciones_ambientales\nfrom turistas_anyo t\nfull join infracciones_ambientales_anyo i\non t.anyo = i.anyo", "relation_name": "\"ods_db\".\"public\".\"m_turistas_infracciones_a\u00f1o\"", "batch_results": null}], "elapsed_time": 0.9200303554534912, "args": {"defer": false, "source_freshness_run_project_hooks": true, "cache_selected_only": false, "require_batched_execution_for_custom_microbatch_strategy": false, "version_check": true, "use_fast_test_edges": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "print": true, "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "state_modified_compare_more_unrendered_values": false, "exclude": [], "empty": false, "require_resource_names_without_spaces": true, "validate_macro_args": false, "state_modified_compare_vars": false, "require_nested_cumulative_type_params": false, "printer_width": 80, "log_format_file": "debug", "log_level": "info", "invocation_command": "dbt run", "upload_to_artifacts_ingest_api": false, "vars": {}, "show_resource_report": false, "profiles_dir": "/home/usuario/BI_infrastructure/BI_project", "require_generic_test_arguments_property": true, "partial_parse": true, "select": [], "log_path": "/home/usuario/BI_infrastructure/BI_project/logs", "require_all_warnings_handled_by_warn_error": false, "log_format": "default", "which": "run", "macro_debugging": false, "populate_cache": true, "project_dir": "/home/usuario/BI_infrastructure/BI_project", "require_explicit_package_overrides_for_builtin_materializations": true, "strict_mode": false, "write_json": true, "show_all_deprecations": false, "quiet": false, "require_yaml_configuration_for_mf_time_spines": false, "skip_nodes_if_on_run_start_fails": false, "static_parser": true, "indirect_selection": "eager", "introspect": true, "favor_state": false, "log_level_file": "debug", "use_colors_file": true, "log_file_max_bytes": 10485760, "use_colors": true}}