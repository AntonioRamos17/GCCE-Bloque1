{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-16T18:50:31.844767Z", "invocation_id": "89bf5a53-d035-4006-b089-a62b408dd1a4", "invocation_started_at": "2025-11-16T18:50:27.670011Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:29.973731Z", "completed_at": "2025-11-16T18:50:29.985907Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:29.986798Z", "completed_at": "2025-11-16T18:50:30.167110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.19670319557189941, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.dim_fecha", "compiled": true, "compiled_code": "with fechas as (\n  select\n    date_trunc('month', d)::date as fecha\n  from generate_series(\n    date '1995-01-01',\n    date '2030-12-01',\n    interval '1 month'\n  ) as d\n)\n\nselect\n  fecha,\n  extract(year from fecha)::int        as anyo,\n  extract(month from fecha)::int       as mes,\n  to_char(fecha, 'TMMonth')            as nombre_mes,\n  extract(quarter from fecha)::int     as trimestre,\n  case when extract(month from fecha) in (6,7,8,9) then true else false end as es_temporada_alta\nfrom fechas\norder by fecha", "relation_name": "\"ods_db\".\"public\".\"dim_fecha\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.177305Z", "completed_at": "2025-11-16T18:50:30.182412Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.183222Z", "completed_at": "2025-11-16T18:50:30.251589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07691717147827148, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.dim_isla", "compiled": true, "compiled_code": "select\n  codigo_isla,\n  nombre_isla\nfrom \"ods_db\".\"public\".\"dim_isla_seed\"", "relation_name": "\"ods_db\".\"public\".\"dim_isla\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.259661Z", "completed_at": "2025-11-16T18:50:30.264118Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.264936Z", "completed_at": "2025-11-16T18:50:30.331169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07410550117492676, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.dim_parque", "compiled": true, "compiled_code": "select distinct\n  codigo_parque\nfrom \"ods_db\".\"public\".\"dim_parque_seed\"", "relation_name": "\"ods_db\".\"public\".\"dim_parque\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.339106Z", "completed_at": "2025-11-16T18:50:30.344313Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.345106Z", "completed_at": "2025-11-16T18:50:30.411330Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07513713836669922, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_afiliaciones_turismo", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(geographical_code))          as codigo_isla,\n    trim(time_code)                         as time_code_raw,\n    trim(measure)                           as medida,\n    trim(measure_code)                      as codigo_medida,\n    cast(obs_value as numeric)              as valor_medicion\n  from \"ods_db\".\"public\".\"afiliaciones_turismo\"\n  where measure_code like 'ABSOLUTE'\n)\n\nselect\n  to_date(time_code_raw || '-01-01', 'YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  medida,\n  valor_medicion\nfrom base", "relation_name": "\"ods_db\".\"public\".\"stg_afiliaciones_turismo\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.419643Z", "completed_at": "2025-11-16T18:50:30.424576Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.425402Z", "completed_at": "2025-11-16T18:50:30.496075Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07903409004211426, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_aguas_residuales", "compiled": true, "compiled_code": "with base as (\n  select\n    trim(time_period_code)                      as anyo,\n    territorio_code                             as codigo_isla,\n    trim(medidas)                               as medida,\n    trim(medidas_code)                          as codigo_medida,\n    upper(trim(tipo_destino_uso))               as destino,    \n    upper(trim(tipo_destino_uso_code))          as codigo_destino,\n    cast(obs_value as numeric)                  as valor_medicion\n  from \"ods_db\".\"public\".\"aguas_residuales\"\n)\n\n\nselect\n  to_date(anyo || '-01-01','YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  codigo_destino,\n  destino,\n  valor_medicion\nfrom base\nwhere upper(destino) LIKE '%AL MAR%'", "relation_name": "\"ods_db\".\"public\".\"stg_aguas_residuales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.503949Z", "completed_at": "2025-11-16T18:50:30.508793Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.509636Z", "completed_at": "2025-11-16T18:50:30.574141Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07278323173522949, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_carencia_bienes_vivienda", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(geographical_code))          as codigo_isla,\n    trim(time_code)                         as time_code_raw,\n    trim(measure)                           as medida,\n    trim(measure_code)                      as codigo_medida,\n    cast(obs_value as numeric)              as valor_medicion\n  from \"ods_db\".\"public\".\"carencia_bienes_vivienda\"\n  where measure_code like 'ABSOLUTE'\n)\n\nselect\n  to_date(time_code_raw || '-01-01', 'YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  medida,\n  valor_medicion\nfrom base\nwhere time_code_raw ~* '^\\d{4}$'", "relation_name": "\"ods_db\".\"public\".\"stg_carencia_bienes_vivienda\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.582060Z", "completed_at": "2025-11-16T18:50:30.586790Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.587615Z", "completed_at": "2025-11-16T18:50:30.655488Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07607412338256836, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_infracciones_acpmn", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(tipo_infraccion))       as tipo_infraccion,    \n    upper(trim(tipo_infraccion_code))  as codigo_tipo_infraccion,\n    territorio_code                         as codigo_isla,\n    trim(time_period_code)                  as anyo,\n    trim(medidas)                           as medida,\n    trim(medidas_code)                      as codigo_medida,\n    cast(obs_value as numeric)              as valor_medicion\n  from \"ods_db\".\"public\".\"infracciones_acpmn\"\n)\n\nselect\n  to_date(anyo || '-01-01','YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_tipo_infraccion,\n  tipo_infraccion,\n  codigo_medida,\n  valor_medicion\nfrom base", "relation_name": "\"ods_db\".\"public\".\"stg_infracciones_acpmn\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.663441Z", "completed_at": "2025-11-16T18:50:30.668616Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.669514Z", "completed_at": "2025-11-16T18:50:30.734808Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07404136657714844, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_infracciones_ambientales", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(geographical_code))                  as codigo_isla,\n    time_code                                       as anyo,\n    trim(measure)                                   as medida,\n    trim(measure_code)                              as codigo_medida,\n    cast(obs_value as numeric)                      as valor_medicion\n  from \"ods_db\".\"public\".\"infracciones_ambientales\"\n)\n\nselect\n  to_date(anyo || '-01-01','YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  medida,\n  valor_medicion\nfrom base", "relation_name": "\"ods_db\".\"public\".\"stg_infracciones_ambientales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.743447Z", "completed_at": "2025-11-16T18:50:30.748120Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.748943Z", "completed_at": "2025-11-16T18:50:30.815725Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07497334480285645, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_ipc_mes", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(geographical_code))          as codigo_isla,\n    trim(time_code)                         as time_code_raw,\n    trim(measure)                           as medida,\n    trim(measure_code)                      as codigo_medida,\n    cast(obs_value as numeric)              as valor_medicion\n  from \"ods_db\".\"public\".\"ipc_mes\"\n  where measure_code like 'ABSOLUTE'\n)\n\nselect\n  to_date(time_code_raw || '-01-01', 'YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  medida,\n  valor_medicion\nfrom base", "relation_name": "\"ods_db\".\"public\".\"stg_ipc_mes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.823526Z", "completed_at": "2025-11-16T18:50:30.828300Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.829095Z", "completed_at": "2025-11-16T18:50:30.894147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07329654693603516, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_menores_pobreza", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(geographical_code))          as codigo_isla,\n    trim(time_code)                         as time_code_raw,\n    trim(measure)                           as medida,\n    trim(measure_code)                      as codigo_medida,\n    cast(obs_value as numeric)              as valor_medicion\n  from \"ods_db\".\"public\".\"menores_pobreza\"\n  where measure_code like 'ABSOLUTE'\n)\n\nselect\n  to_date(time_code_raw || '-01-01', 'YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  medida,\n  valor_medicion\nfrom base\nwhere time_code_raw ~* '^\\d{4}$'", "relation_name": "\"ods_db\".\"public\".\"stg_menores_pobreza\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.901990Z", "completed_at": "2025-11-16T18:50:30.907143Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.907976Z", "completed_at": "2025-11-16T18:50:30.978933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07956218719482422, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_turistas_recibidos", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(geographical_code))          as codigo_isla,\n    trim(time_code)                         as time_code_raw,\n    trim(measure)                           as medida,\n    trim(measure_code)                      as codigo_medida,\n    cast(obs_value as numeric)              as valor_medicion\n  from \"ods_db\".\"public\".\"turistas_recibidos\"\n)\n\nselect\n  to_date(time_code_raw || '-01', 'YYYY-MM-DD') as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  medida,\n  valor_medicion\nfrom base\nwhere time_code_raw !~* '^\\d{4}$'", "relation_name": "\"ods_db\".\"public\".\"stg_turistas_recibidos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:30.987086Z", "completed_at": "2025-11-16T18:50:30.992055Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:30.992866Z", "completed_at": "2025-11-16T18:50:31.058535Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07405591011047363, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_valor_vivienda_m2", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(geographical_code))          as codigo_isla,\n    trim(time_code)                         as time_code_raw,\n    trim(measure)                           as medida,\n    trim(measure_code)                      as codigo_medida,\n    cast(obs_value as numeric)              as valor_medicion\n  from \"ods_db\".\"public\".\"valor_vivienda_m2\"\n  where measure_code like 'ABSOLUTE'\n)\n\nselect\n  make_date(\n    split_part(time_code_raw, '-', 1)::int,\n    case split_part(time_code_raw, '-', 2) \n      when 'Q1' then 1   -- enero\n      when 'Q2' then 4   -- abril\n      when 'Q3' then 7   -- julio\n      when 'Q4' then 10  -- octubre\n    end,\n    1\n  )::date as fecha_aproximada,\n  codigo_isla,\n  codigo_medida,\n  medida,\n  valor_medicion\nfrom base\nwhere time_code_raw !~* '^\\d{4}$'", "relation_name": "\"ods_db\".\"public\".\"stg_valor_vivienda_m2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:31.066732Z", "completed_at": "2025-11-16T18:50:31.071982Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:31.073082Z", "completed_at": "2025-11-16T18:50:31.141503Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07751584053039551, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.stg_visitantes_espacios_naturales", "compiled": true, "compiled_code": "with base as (\n  select\n    upper(trim(espacio_natural_protegido_code))     as codigo_parque,\n    trim(time_period_code)                          as raw_anyo,\n    trim(medidas)                                   as medida,\n    trim(medidas_code)                              as codigo_medida,\n    cast(obs_value as numeric)                      as valor_medicion\n  from \"ods_db\".\"public\".\"visitantes_espacios_naturales\"\n)\n\nselect\n  case\n    when raw_anyo ~ '^\\d{4}$' then to_date(raw_anyo || '-01-01','YYYY-MM-DD')\n    when raw_anyo ~ '^\\d{4}-M\\d{2}$' then to_date(regexp_replace(raw_anyo, '-M', '-') || '-01','YYYY-MM-DD')\n    else null\n  end as fecha_aproximada,\n  codigo_parque,\n  codigo_medida,\n  medida,\n  valor_medicion\n  from base", "relation_name": "\"ods_db\".\"public\".\"stg_visitantes_espacios_naturales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:31.149714Z", "completed_at": "2025-11-16T18:50:31.154761Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:31.155591Z", "completed_at": "2025-11-16T18:50:31.215825Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06915402412414551, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.f_infracciones_ambientales_mes", "compiled": true, "compiled_code": "with base as (\n  select\n    ia.fecha_aproximada,\n    ia.codigo_isla,\n    i.nombre_isla,\n    ia.valor_medicion::numeric as n_infracciones_ambientales\n  from \"ods_db\".\"public\".\"stg_infracciones_ambientales\" ia\n  join \"ods_db\".\"public\".\"dim_isla\" i\n    on i.codigo_isla = ia.codigo_isla\n  where ia.codigo_medida LIKE '%ABSOLUTE%'\n  order by ia.codigo_isla, ia.fecha_aproximada\n)\nselect\n  fecha_aproximada,\n  codigo_isla,\n  nombre_isla,\n  n_infracciones_ambientales\nfrom base", "relation_name": "\"ods_db\".\"public\".\"f_infracciones_ambientales_mes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:31.225392Z", "completed_at": "2025-11-16T18:50:31.231427Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:31.232266Z", "completed_at": "2025-11-16T18:50:31.297384Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07497382164001465, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.f_turistas_isla_mes", "compiled": true, "compiled_code": "with base as (\n  select\n    tr.fecha_aproximada,\n    tr.codigo_isla,\n    i.nombre_isla,\n    tr.valor_medicion::numeric as n_turistas\n  from \"ods_db\".\"public\".\"stg_turistas_recibidos\" tr\n  join \"ods_db\".\"public\".\"dim_isla\" i\n    on i.codigo_isla = tr.codigo_isla\n  where tr.codigo_medida LIKE '%ABSOLUTE%'\n  order by tr.codigo_isla, tr.fecha_aproximada\n  -- group by tr.fecha_aproximada, tr.codigo_isla, tr.codigo_medida, i.nombre_isla\n  -- having tr.codigo_medida LIKE '%ABSOLUTE%'\n)\nselect\n  fecha_aproximada,\n  codigo_isla,\n  nombre_isla,\n  n_turistas\nfrom base", "relation_name": "\"ods_db\".\"public\".\"f_turistas_isla_mes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:31.306565Z", "completed_at": "2025-11-16T18:50:31.312638Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:31.313470Z", "completed_at": "2025-11-16T18:50:31.378324Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07466363906860352, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.f_visitantes_parque_anyo", "compiled": true, "compiled_code": "with base as (\n  select\n    extract(year from fecha_aproximada)::int as anyo,\n    v.codigo_parque,\n    v.valor_medicion::numeric as n_visitantes\n  from \"ods_db\".\"public\".\"stg_visitantes_espacios_naturales\" v\n)\n\nselect\n  anyo,\n  p.codigo_parque,\n  sum(n_visitantes) as n_visitantes\nfrom base b\nleft join \"ods_db\".\"public\".\"dim_parque\" p\n  on b.codigo_parque = p.codigo_parque\ngroup by anyo, p.codigo_parque", "relation_name": "\"ods_db\".\"public\".\"f_visitantes_parque_anyo\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:31.386216Z", "completed_at": "2025-11-16T18:50:31.391549Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:31.392385Z", "completed_at": "2025-11-16T18:50:31.449845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06625509262084961, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.m_aguas_turistas", "compiled": true, "compiled_code": "with turistas_anyo as (\n  select\n  EXTRACT(YEAR FROM fecha_aproximada)::int as anyo,\n  codigo_isla,\n  nombre_isla,\n  sum(n_turistas) as n_turistas\n  from \"ods_db\".\"public\".\"f_turistas_isla_mes\"\n  group by anyo, codigo_isla, nombre_isla\n  having EXTRACT(YEAR FROM fecha_aproximada)::int >= 2010 and \n  EXTRACT(YEAR FROM fecha_aproximada)::int <= 2024 and\n  codigo_isla LIKE '%ES70'\n),\n\naguas_anyo as (\n  select\n  EXTRACT(YEAR FROM fecha_aproximada)::int as anyo,\n  codigo_isla,\n  sum(valor_medicion) as v_aguas_residuales\n  from \"ods_db\".\"public\".\"stg_aguas_residuales\"\n  group by anyo, codigo_isla, codigo_medida\n  having EXTRACT(YEAR FROM fecha_aproximada)::int >= 2020 and \n  EXTRACT(YEAR FROM fecha_aproximada)::int <= 2025 and\n  codigo_isla LIKE '%ES70' and\n  codigo_medida LIKE '%VOLUMEN'\n)\n\nselect\n  t.anyo,\n  t.codigo_isla,\n  t.nombre_isla,\n  t.n_turistas as n_turistas,\n  a.v_aguas_residuales as v_aguas_residuales,\n  ln(t.n_turistas) as escalado_turistas,\n  ln(a.v_aguas_residuales) as escalado_aguas_residuales\nfrom turistas_anyo t\nfull join aguas_anyo a\non t.anyo = a.anyo", "relation_name": "\"ods_db\".\"public\".\"m_aguas_turistas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:31.457858Z", "completed_at": "2025-11-16T18:50:31.463112Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:31.463963Z", "completed_at": "2025-11-16T18:50:31.521531Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06649994850158691, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.m_turismo_empleo_anyo", "compiled": true, "compiled_code": "with turistas_anyo as (\n    select\n      extract(year from fecha_aproximada)::int as anyo,\n      codigo_isla,\n      nombre_isla,\n      sum(n_turistas) as n_turistas\n    from \"ods_db\".\"public\".\"f_turistas_isla_mes\"\n    group by anyo, codigo_isla, nombre_isla\n),\n\nafiliaciones_anyo as (\n    select\n      extract(year from fecha_aproximada)::int as anyo,\n      codigo_isla,\n      sum(valor_medicion) as n_afiliaciones_turismo\n    from \"ods_db\".\"public\".\"stg_afiliaciones_turismo\"\n    group by anyo, codigo_isla\n)\n\nselect\n  t.anyo,\n  t.codigo_isla,\n  t.nombre_isla,\n  t.n_turistas,\n  a.n_afiliaciones_turismo,\n  (a.n_afiliaciones_turismo::numeric / nullif(t.n_turistas, 0)) as afiliaciones_por_turista,\n  ln(t.n_turistas)              as log_turistas,\n  ln(nullif(a.n_afiliaciones_turismo, 0)) as log_afiliaciones\nfrom turistas_anyo t\nleft join afiliaciones_anyo a\n  on t.anyo = a.anyo\n and t.codigo_isla = a.codigo_isla\norder by t.anyo", "relation_name": "\"ods_db\".\"public\".\"m_turismo_empleo_anyo\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:31.529935Z", "completed_at": "2025-11-16T18:50:31.538309Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:31.539074Z", "completed_at": "2025-11-16T18:50:31.594857Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06755328178405762, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.m_turismo_parques_anyo", "compiled": true, "compiled_code": "with turistas_anyo_canarias as (\n  select\n    extract(year from fecha_aproximada)::int as anyo,\n    sum(n_turistas) as n_turistas_canarias\n  from \"ods_db\".\"public\".\"f_turistas_isla_mes\"\n  group by anyo\n),\n\nvisitantes_parques_anyo as (\n  select\n    extract(year from fecha_aproximada)::int as anyo,\n    sum(valor_medicion)::numeric as n_visitantes_parques\n  from \"ods_db\".\"public\".\"stg_visitantes_espacios_naturales\"\n  group by anyo\n)\n\nselect\n  t.anyo,\n  t.n_turistas_canarias,\n  v.n_visitantes_parques,\n  (v.n_visitantes_parques::numeric / nullif(t.n_turistas_canarias, 0)) as visitantes_parques_por_turista,\n  ln(nullif(t.n_turistas_canarias, 0))    as log_turistas_canarias,\n  ln(nullif(v.n_visitantes_parques, 0))   as log_visitantes_parques\nfrom turistas_anyo_canarias t\nleft join visitantes_parques_anyo v\n  on t.anyo = v.anyo", "relation_name": "\"ods_db\".\"public\".\"m_turismo_parques_anyo\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:31.602773Z", "completed_at": "2025-11-16T18:50:31.608409Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:31.609211Z", "completed_at": "2025-11-16T18:50:31.665541Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06536197662353516, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.m_turismo_vivienda_anyo", "compiled": true, "compiled_code": "with turistas_anyo as (\n  select\n    extract(year from fecha_aproximada)::int as anyo,\n    codigo_isla,\n    nombre_isla,\n    sum(n_turistas) as n_turistas\n  from \"ods_db\".\"public\".\"f_turistas_isla_mes\"\n  group by anyo, codigo_isla, nombre_isla\n),\n\nvivienda_anyo as (\n  select\n    extract(year from fecha_aproximada)::int as anyo,\n    codigo_isla,\n    avg(valor_medicion) as precio_m2_medio\n  from \"ods_db\".\"public\".\"stg_valor_vivienda_m2\"\n  group by anyo, codigo_isla\n),\n\ncarencia_anyo as (\n  select\n    extract(year from fecha_aproximada)::int as anyo,\n    codigo_isla,\n    avg(valor_medicion) as carencia_bienes_vivienda\n  from \"ods_db\".\"public\".\"stg_carencia_bienes_vivienda\"\n  group by anyo, codigo_isla\n)\n\nselect\n  t.anyo,\n  t.codigo_isla,\n  t.nombre_isla,\n  t.n_turistas,\n  v.precio_m2_medio,\n  c.carencia_bienes_vivienda,\n  ln(nullif(t.n_turistas, 0))           as log_turistas,\n  ln(nullif(v.precio_m2_medio, 0))      as log_precio_m2,\n  ln(nullif(c.carencia_bienes_vivienda, 0)) as log_carencia\nfrom turistas_anyo t\nleft join vivienda_anyo v\n  on t.anyo = v.anyo\n and t.codigo_isla = v.codigo_isla\nleft join carencia_anyo c\n  on t.anyo = c.anyo\n and t.codigo_isla = c.codigo_isla\norder by t.anyo", "relation_name": "\"ods_db\".\"public\".\"m_turismo_vivienda_anyo\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:31.673489Z", "completed_at": "2025-11-16T18:50:31.678813Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:31.679691Z", "completed_at": "2025-11-16T18:50:31.740220Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06940722465515137, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.m_turistas_infracciones_a\u00f1o", "compiled": true, "compiled_code": "with turistas_anyo as (\n  select\n  EXTRACT(YEAR FROM fecha_aproximada)::int as anyo,\n  codigo_isla,\n  nombre_isla,\n  sum(n_turistas) as n_turistas\n  from \"ods_db\".\"public\".\"f_turistas_isla_mes\"\n  group by anyo, codigo_isla, nombre_isla\n  having EXTRACT(YEAR FROM fecha_aproximada)::int >= 2010 and \n  EXTRACT(YEAR FROM fecha_aproximada)::int <= 2024 and\n  codigo_isla LIKE '%ES70'\n),\n\ninfracciones_ambientales_anyo as (\n  select\n  EXTRACT(YEAR FROM fecha_aproximada)::int as anyo,\n  codigo_isla,\n  nombre_isla,\n  sum(n_infracciones_ambientales) as n_infracciones_ambientales\n  from \"ods_db\".\"public\".\"f_infracciones_ambientales_mes\"\n  group by anyo, codigo_isla, nombre_isla\n  having EXTRACT(YEAR FROM fecha_aproximada)::int >= 2010 and \n  EXTRACT(YEAR FROM fecha_aproximada)::int <= 2024 and\n  codigo_isla LIKE '%ES70'\n)\n\nselect\n  t.anyo,\n  t.codigo_isla,\n  t.nombre_isla,\n  t.n_turistas as n_turistas,\n  i.n_infracciones_ambientales as n_infracciones_ambientales,\n  ln(t.n_turistas) as escalado_turistas,\n  ln(i.n_infracciones_ambientales) as escalado_infracciones_ambientales\nfrom turistas_anyo t\nfull join infracciones_ambientales_anyo i\non t.anyo = i.anyo", "relation_name": "\"ods_db\".\"public\".\"m_turistas_infracciones_a\u00f1o\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-16T18:50:31.748943Z", "completed_at": "2025-11-16T18:50:31.754485Z"}, {"name": "execute", "started_at": "2025-11-16T18:50:31.755291Z", "completed_at": "2025-11-16T18:50:31.811342Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06523561477661133, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.BI_project.m_turismo_ambiental_completo_anyo", "compiled": true, "compiled_code": "with aguas as (\n    select\n        anyo,\n        codigo_isla,\n        nombre_isla,\n        n_turistas,\n        v_aguas_residuales\n    from \"ods_db\".\"public\".\"m_aguas_turistas\"\n),\n\ninfrac as (\n  select\n    anyo,\n    codigo_isla,\n    nombre_isla,\n    n_turistas as n_turistas_infrac,\n    n_infracciones_ambientales\n  from \"ods_db\".\"public\".\"m_turistas_infracciones_a\u00f1o\"\n)\n\nselect\n  coalesce(a.anyo, i.anyo) as anyo,\n  coalesce(a.codigo_isla, i.codigo_isla) as codigo_isla,\n  coalesce(a.nombre_isla, i.nombre_isla) as nombre_isla,\n\n  -- Turistas (si viene de ambos sitios, preferimos el de aguas, pero deber\u00edan coincidir)\n  coalesce(a.n_turistas, i.n_turistas_infrac) as n_turistas,\n\n  a.v_aguas_residuales,\n  i.n_infracciones_ambientales,\n\n  ln(nullif(coalesce(a.n_turistas, i.n_turistas_infrac), 0))      as log_turistas,\n  ln(nullif(a.v_aguas_residuales, 0))                             as log_aguas_residuales,\n  ln(nullif(i.n_infracciones_ambientales, 0))                     as log_infracciones\nfrom aguas a\nfull join infrac i\n  on a.anyo = i.anyo\n and a.codigo_isla = i.codigo_isla\n order by a.anyo", "relation_name": "\"ods_db\".\"public\".\"m_turismo_ambiental_completo_anyo\"", "batch_results": null}], "elapsed_time": 2.2277603149414062, "args": {"log_path": "/home/usuario/BI_infrastructure/BI_project/logs", "printer_width": 80, "cache_selected_only": false, "use_colors_file": true, "log_format_file": "debug", "require_generic_test_arguments_property": true, "source_freshness_run_project_hooks": true, "select": [], "static_parser": true, "populate_cache": true, "profiles_dir": "/home/usuario/BI_infrastructure/BI_project", "require_all_warnings_handled_by_warn_error": false, "strict_mode": false, "which": "run", "write_json": true, "use_fast_test_edges": false, "log_format": "default", "quiet": false, "macro_debugging": false, "validate_macro_args": false, "empty": false, "indirect_selection": "eager", "vars": {}, "upload_to_artifacts_ingest_api": false, "print": true, "project_dir": "/home/usuario/BI_infrastructure/BI_project", "defer": false, "require_yaml_configuration_for_mf_time_spines": false, "show_all_deprecations": false, "exclude": [], "show_resource_report": false, "send_anonymous_usage_stats": true, "state_modified_compare_more_unrendered_values": false, "state_modified_compare_vars": false, "favor_state": false, "invocation_command": "dbt run", "log_file_max_bytes": 10485760, "partial_parse": true, "partial_parse_file_diff": true, "skip_nodes_if_on_run_start_fails": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_batched_execution_for_custom_microbatch_strategy": false, "introspect": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_nested_cumulative_type_params": false, "version_check": true, "log_level": "info", "log_level_file": "debug", "use_colors": true, "require_resource_names_without_spaces": true}}